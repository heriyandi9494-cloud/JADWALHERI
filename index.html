<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jadwal Aktivitas Sehari-hari</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body { background-image: url('https://i.postimg.cc/NGrQg52J/Screenshot-26.png'); font-family: Arial, sans-serif; padding: 20px; }
  table { width: 100%; border-collapse: collapse; }
  th, td { text-align: center; padding: 10px; border-radius: 8px; transition: all 0.3s ease; }
  th { background-color: #ee0a25; color: rgb(235, 13, 13); }
  tr:nth-child(even) td { background-color: #f6f5f9; }
  tr:hover td { background-color: #ffe082; cursor: pointer; }
  select, input[type="time"], input[type="date"] { width: 100%; padding: 5px; border-radius: 5px; border: 1px solid #ccc; }
  .keterangan { font-weight: bold; color: #d32f2f; }
  .Tidur { background-color: #b2dfdb !important; }
  .Kerja { background-color: #0ecf1179 !important; }
  .Belajar { background-color: #0f2be7 !important; }
  .Olahraga { background-color: #aed581 !important; }
  .Santai { background-color: #f48fb1 !important; }
  .hapus-btn { color: #f0f0f6; background-color: #d32f2f; border: none; padding: 3px 7px; border-radius: 5px; cursor: pointer; }

  /* Glow / bercahaya */
  .glow-bar {
    color: rgb(237, 237, 239);
    font-weight: bold;
    text-align: center;
    border-radius: 12px;
    padding: 10px 0;
    transition: all 0.5s ease;
    box-shadow: 0 0 10px rgba(238, 4, 4, 0.2);
  }
</style>
</head>
<body>

<h2 class="text-center mb-4"style="color: white;">ğ‰ğšğğ°ğšğ¥ ğ€ğ¤ğ­ğ¢ğ¯ğ¢ğ­ğšğ¬ ğ‡ğğ«ğ¢ ğ’ğğ¡ğšğ«ğ¢-ğ¡ğšğ«ğ¢</h2>

<div class="mb-3">
  <label style="color: rgb(247, 245, 245);">ğğ¢ğ¥ğ¢ğ¡ ğ“ğšğ§ğ ğ ğšğ¥</label>
  <input type="date" id="filterTanggal" onchange="updateProgressBars()">
</div>

<div class="mb-3">
  <label style="color: rgb(245, 240, 240);">ğ“ğ¨ğ­ğšğ¥ ğ‰ğšğ¦ ğŠğğ«ğ£ğš</label>
  <div id="progressKerja" class="glow-bar mb-2" style="width:0%">0 Jam</div>

  <label style="color: rgb(240, 234, 234);">ğ€ğ¤ğ­ğ¢ğ¯ğ¢ğ­ğšğ¬ ğ‹ğšğ¢ğ§</label>
  <div id="progressLain" class="glow-bar mb-2" style="width:0%">0% - </div>

  <label style="color: rgb(253, 248, 248);">ğ‰ğšğ¦ ğ“ğ¢ğğ®ğ«</label>
  <div id="progressTidur" class="glow-bar mb-3" style="width:0%">0% - </div>
</div>

<table class="table table-responsive" id="jadwal-table">
  <thead>
    <tr>
      <th>No.</th>
      <th>Hari</th>
      <th>Tanggal</th>
      <th>Jenis Aktivitas</th>
      <th>Waktu Mulai</th>
      <th>Waktu Selesai</th>
      <th>Durasi (Jam)</th>
      <th>Keterangan</th>
      <th>Aksi</th>
    </tr>
  </thead>
  <tbody id="jadwal-body"></tbody>
</table>

<script>
let jadwalData = JSON.parse(localStorage.getItem('jadwalData')) || [];
const today = new Date().toISOString().split('T')[0];
document.getElementById('filterTanggal').value = today;

function tambahBaris(data={}, index=null){
  const tbody = document.getElementById('jadwal-body');
  const row = tbody.insertRow(index===null ? -1 : index);

  const no = row.insertCell();
  const hari = row.insertCell();
  const tanggal = row.insertCell();
  const jenis = row.insertCell();
  const mulai = row.insertCell();
  const selesai = row.insertCell();
  const durasi = row.insertCell();
  const keterangan = row.insertCell();
  const aksi = row.insertCell();

  no.innerText = tbody.rows.length;
  hari.contentEditable = true;
  hari.innerText = data.hari || '';
  tanggal.innerHTML = `<input type="date" value="${data.tanggal || today}" onchange="updateData(this)">`;
  jenis.innerHTML = `
    <select onchange="updateData(this)">
      <option value="Tidur" ${data.jenis==='Tidur'?'selected':''}>Tidur</option>
      <option value="Berangkat Kerja" ${data.jenis==='Berangkat Kerja'?'selected':''}>Berangkat Kerja</option>
      <option value="Pulang Kerja" ${data.jenis==='Pulang Kerja'?'selected':''}>Pulang Kerja</option>
      <option value="Mandi" ${data.jenis==='Mandi'?'selected':''}>Mandi</option>
      <option value="Kerja" ${data.jenis==='Kerja'?'selected':''}>Kerja</option>
      <option value="Belajar" ${data.jenis==='Belajar'?'selected':''}>Belajar</option>
      <option value="Gym" ${data.jenis==='Gym'?'selected':''}>Gym</option>
      <option value="Santai" ${data.jenis==='Santai'?'selected':''}>Santai</option>
      <option value="Play Game" ${data.jenis==='Play Game'?'selected':''}>Play Game</option>
    </select>
  `;
  mulai.innerHTML = `<input type="time" value="${data.mulai || ''}" onchange="updateData(this)">`;
  selesai.innerHTML = `<input type="time" value="${data.selesai || ''}" onchange="updateData(this)">`;
  durasi.className = 'produktif';
  durasi.innerText = data.durasi || '0';
  keterangan.className = 'keterangan';
  keterangan.innerText = data.keterangan || '';
  aksi.innerHTML = `<button class="hapus-btn" onclick="hapusBaris(this)">Hapus</button>`;

  updateRowColor(row);

  row.querySelectorAll('input, select').forEach(input=>{
    input.addEventListener('change', ()=>{
      hitungDurasi(row);
      updateRowColor(row);
      saveData();
      updateProgressBars();
      if(row.rowIndex === tbody.rows.length && isRowFilled(row)) tambahBaris();
    });
  });

  saveData();
  updateProgressBars();
}

function updateData(elem){
  const row = elem.closest('tr');
  hitungDurasi(row);
  updateRowColor(row);
  saveData();
  updateProgressBars();
}

function isRowFilled(row){
  return [...row.querySelectorAll('input, select')].some(i => i.value);
}

function hitungDurasi(row){
  const mulai = row.cells[4].querySelector('input').value;
  const selesai = row.cells[5].querySelector('input').value;
  const jenis = row.cells[3].querySelector('select').value;
  let dur = 0;
  let keteranganVal = '';

  if(mulai && selesai){
    let start = new Date(`1970-01-01T${mulai}:00`);
    let end = new Date(`1970-01-01T${selesai}:00`);
    dur = (end - start)/(1000*60*60);
    if(dur < 0) dur += 24;

    if(jenis === 'Tidur'){
      keteranganVal = dur >= 7 ? 'Sangat Baik' : 'Kurang Baik';
    } else if(jenis !== 'Kerja'){ 
      keteranganVal = dur >= 4 ? 'Baik' : 'Baik';
    } else { 
      keteranganVal = 'Jam Kerjamu Masih Ideal';
    }
  }

  row.cells[6].innerText = dur.toFixed(2);
  row.cells[7].innerText = keteranganVal;
}

function updateRowColor(row){
  const jenis = row.cells[3].querySelector('select').value;
  row.className = jenis;
}

function saveData(){
  const tbody = document.getElementById('jadwal-body');
  const data = [];
  for(let row of tbody.rows){
    data.push({
      hari: row.cells[1].innerText,
      tanggal: row.cells[2].querySelector('input').value,
      jenis: row.cells[3].querySelector('select').value,
      mulai: row.cells[4].querySelector('input').value,
      selesai: row.cells[5].querySelector('input').value,
      durasi: row.cells[6].innerText,
      keterangan: row.cells[7].innerText
    });
  }
  localStorage.setItem('jadwalData', JSON.stringify(data));
}

function hapusBaris(btn){
  const row = btn.closest('tr');
  row.remove();
  saveData();
  updateNoUrut();
  updateProgressBars();
}

function updateNoUrut(){
  const tbody = document.getElementById('jadwal-body');
  for(let i=0;i<tbody.rows.length;i++) tbody.rows[i].cells[0].innerText = i+1;
}

function updateProgressBars(){
  const tbody = document.getElementById('jadwal-body');
  const filterDate = document.getElementById('filterTanggal').value;

  let totalKerja=0, totalLain=0, totalTidur=0;

  for(let row of tbody.rows){
    const tanggal = row.cells[2].querySelector('input').value;
    if(!filterDate || tanggal === filterDate){
      const jenis = row.cells[3].querySelector('select').value;
      const dur = parseFloat(row.cells[6].innerText)||0;

      if(jenis === 'Kerja') totalKerja += dur;
      else if(jenis === 'Tidur') totalTidur += dur;
      else totalLain += dur;
    }
  }

  // Warna + glow dinamis
  const barKerja = document.getElementById('progressKerja');
  barKerja.style.width = Math.min(totalKerja/12*100,100)+'%';
  barKerja.style.background = "#ff5733";
  barKerja.style.boxShadow = "0 0 15px #ff5733";
  barKerja.innerText = totalKerja.toFixed(2)+' Jam';

  const barLain = document.getElementById('progressLain');
  let persenLain = Math.min(totalLain/12*100,100);
  barLain.style.width = persenLain+'%';
  barLain.style.background = "#ffa500";
  barLain.style.boxShadow = "0 0 15px #ffa500";
  barLain.innerText = persenLain.toFixed(0)+'% - Cukup Baik';

  const barTidur = document.getElementById('progressTidur');
  let persenTidur = Math.min(totalTidur/8*100,100);
  barTidur.style.width = persenTidur+'%';
  barTidur.style.background = "#4caf50";
  barTidur.style.boxShadow = "0 0 15px #4caf50";
  barTidur.innerText = persenTidur.toFixed(0)+'% - '+(totalTidur>=7?'Sangat Baik':'Kurang Baik');
}

jadwalData.forEach(d=>tambahBaris(d));
if(jadwalData.length===0) tambahBaris();
</script>
</body>
</html>
